# Установка версии 2.5 (с авторизацией)

## Новые возможности

- ✅ Авторизация пользователей (вход/регистрация)
- ✅ История маршрутов хранится в БД (привязана к пользователю)
- ✅ Блок пользователя в левом нижнем углу
- ✅ Пароли хэшируются (безопасное хранение)

## Шаг 1: Обновление базы данных

Выполните SQL-скрипт для создания новых таблиц:

```sql
-- Откройте phpMyAdmin и выполните:
source schema_v2.5.sql;

-- Или скопируйте содержимое schema_v2.5.sql и выполните вручную
```

Это создаст таблицы:
- `users` - пользователи
- `route_history` - история маршрутов

## Шаг 2: Проверка настроек

Убедитесь, что в `api/config.php` установлено:
```php
'data_source' => 'database', // Для работы с БД
```

## Шаг 3: Проверка работы

1. Откройте `login.php` в браузере
2. Зарегистрируйте нового пользователя
3. Войдите в систему
4. Постройте маршрут - он должен сохраниться в истории
5. Проверьте блок в левом нижнем углу - там должен быть ваш логин и история

## Структура файлов

- `login.php` - страница входа
- `register.php` - страница регистрации
- `api/auth.php` - API для авторизации
- `api/route_history.php` - API для истории маршрутов
- `schema_v2.5.sql` - SQL скрипт для создания таблиц

## Безопасность

- Пароли хэшируются через `password_hash()` (bcrypt)
- Используются PHP сессии для авторизации
- Все запросы к API требуют авторизации (кроме login/register)

